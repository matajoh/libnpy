<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libnpy: libnpy</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libnpy<span id="projectnumber">&#160;2.0.0</span>
   </div>
   <div id="projectbrief">Lightweight C++ library for reading and writing NPY and NPZ files</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">libnpy</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md1"></a> <code>libnpy</code> is a multi-platform C++ library for reading and writing NPY and NPZ files, with an additional .NET interface. It was built with the intention of making it easier for multi-language projects to use NPZ and NPY files for data storage, given their simplicity and support across most Python deep learning frameworks.</p>
<p>The implementations in this library are based upon the following file format documents:</p><ul>
<li><b>NPY</b>: The NPY file format is documented by the NumPy developers in <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.lib.format.html">this note</a></li>
<li><b>NPZ</b>: While not explicitly documented, the NPZ format is a a PKZIP archive of NPY files, and thus is documented here: <a href="https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT">https://pkware.cachefly.net/webdocs/casestudies/APPNOTE.TXT</a>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Getting Started</h1>
<p>Start by installing <a href="https://cmake.org/">CMake</a> in the way appropriate for your environment.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Linux</h2>
<p>Create a build directory and initialize the cmake project: </p><pre class="fragment">mkdir build
cd build
cmake .. --preset release
</pre><p> You can then build and run the tests using: </p><pre class="fragment">make
ctest
</pre> <h2><a class="anchor" id="autotoc_md4"></a>
Windows</h2>
<p>Create a build directory and initialize the cmake project: </p><pre class="fragment">mkdir build
cd build
cmake .. --preset release
</pre><p> You can then build and run the tests using: </p><pre class="fragment">cmake --build . --config Release
ctest -C Release
</pre> <h1><a class="anchor" id="autotoc_md5"></a>
Sample code</h1>
<p>Once the library has been built and installed, you can begin to use it in your code. We have provided some <a href="https://github.com/matajoh/libnpy/tree/main/examples/">example programs</a> (and naturally the <a href="https://github.com/matajoh/libnpy/tree/main/test">tests</a> as well) which show how to use the library, but the basic concepts are as follows. For the purpose of this sample code we will use the built-in <a href="https://github.com/matajoh/libnpy/tree/main/src/tensor.h">tensor</a> class, but you should use your own tensor class as appropriate (see the <a href="https://github.com/matajoh/libnpy/tree/main/examples/custom_tensors">custom tensor example</a> for details.)</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="npy_8h.html">npy/npy.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// create a tensor object</span></div>
<div class="line">    <a class="code hl_class" href="classnpy_1_1tensor.html">npy::tensor&lt;std::uint8_t&gt;</a> color({32, 32, 3});</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// fill it with some data</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; color.shape(0); ++row)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; color.shape(1); ++col)</div>
<div class="line">        {</div>
<div class="line">            color(row, col, 0) = <span class="keyword">static_cast&lt;</span>std::uint8_t<span class="keyword">&gt;</span>(row &lt;&lt; 3);</div>
<div class="line">            color(row, col, 1) = <span class="keyword">static_cast&lt;</span>std::uint8_t<span class="keyword">&gt;</span>(col &lt;&lt; 3);</div>
<div class="line">            color(row, col, 2) = 128;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// save it to disk as an NPY file</span></div>
<div class="line">    <a class="code hl_function" href="namespacenpy.html#a89c763e3f4dbd0b67dc58779381a0ca6">npy::save</a>(<span class="stringliteral">&quot;color.npy&quot;</span>, color);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// we can manually set the endianness to use</span></div>
<div class="line">    <a class="code hl_function" href="namespacenpy.html#a89c763e3f4dbd0b67dc58779381a0ca6">npy::save</a>(<span class="stringliteral">&quot;color.npy&quot;</span>, color, <a class="code hl_enumvalue" href="namespacenpy.html#a600eb6c59cbacf81349556a92deffa11aa60c6c694491d75b439073b8cb05b139">npy::endian_t::BIG</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// the built-in tensor class also has a save method</span></div>
<div class="line">    color.save(<span class="stringliteral">&quot;color.npy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// we can peek at the header of the file</span></div>
<div class="line">    <a class="code hl_struct" href="structnpy_1_1header__info.html">npy::header_info</a> header = <a class="code hl_function" href="namespacenpy.html#a38835ff556104fbc4cdef558825c18a6">npy::peek</a>(<span class="stringliteral">&quot;color.npy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// we can load it back the same way</span></div>
<div class="line">    color = npy::load&lt;std::uint8_t, npy::tensor&gt;(<span class="stringliteral">&quot;color.npy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// let&#39;s create a second tensor as well</span></div>
<div class="line">    <a class="code hl_class" href="classnpy_1_1tensor.html">npy::tensor&lt;float&gt;</a> gray({32, 32});</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row = 0; row &lt; gray.shape(0); ++row)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col = 0; col &lt; gray.shape(1); ++col)</div>
<div class="line">        {</div>
<div class="line">            gray(row, col) = 0.21f * color(row, col, 0) +</div>
<div class="line">                             0.72f * color(row, col, 1) +</div>
<div class="line">                             0.07f * color(row, col, 2);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// we can write them to an NPZ file</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_class" href="classnpy_1_1npzfilewriter.html">npy::npzfilewriter</a> output(<span class="stringliteral">&quot;test.npz&quot;</span>);</div>
<div class="line">        output.write(<span class="stringliteral">&quot;color.npy&quot;</span>, color);</div>
<div class="line">        output.write(<span class="stringliteral">&quot;gray.npy&quot;</span>, gray);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// and we can read them back out again</span></div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_class" href="classnpy_1_1npzfilereader.html">npy::npzfilereader</a> input(<span class="stringliteral">&quot;test.npz&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// we can test to see if the archive contains a file</span></div>
<div class="line">        <span class="keywordflow">if</span> (input.contains(<span class="stringliteral">&quot;color.npy&quot;</span>))</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// and peek at its header</span></div>
<div class="line">            header = input.peek(<span class="stringliteral">&quot;color.npy&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        color = input.read&lt;<a class="code hl_class" href="classnpy_1_1tensor.html">npy::tensor&lt;std::uint8_t&gt;</a>&gt;(<span class="stringliteral">&quot;color.npy&quot;</span>);</div>
<div class="line">        gray = input.read&lt;<a class="code hl_class" href="classnpy_1_1tensor.html">npy::tensor&lt;float&gt;</a>&gt;(<span class="stringliteral">&quot;gray.npy&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassnpy_1_1npzfilereader_html"><div class="ttname"><a href="classnpy_1_1npzfilereader.html">npy::npzfilereader</a></div><div class="ttdoc">Class handling reading of an NPZ from a file on disk.</div><div class="ttdef"><b>Definition</b> npy.h:559</div></div>
<div class="ttc" id="aclassnpy_1_1npzfilewriter_html"><div class="ttname"><a href="classnpy_1_1npzfilewriter.html">npy::npzfilewriter</a></div><div class="ttdoc">Class which handles writing of an NPZ archive to disk.</div><div class="ttdef"><b>Definition</b> npy.h:429</div></div>
<div class="ttc" id="aclassnpy_1_1tensor_html"><div class="ttname"><a href="classnpy_1_1tensor.html">npy::tensor</a></div><div class="ttdoc">The default tensor class.</div><div class="ttdef"><b>Definition</b> npy.h:650</div></div>
<div class="ttc" id="anamespacenpy_html_a38835ff556104fbc4cdef558825c18a6"><div class="ttname"><a href="namespacenpy.html#a38835ff556104fbc4cdef558825c18a6">npy::peek</a></div><div class="ttdeci">header_info peek(std::basic_istream&lt; CHAR &gt; &amp;input)</div><div class="ttdoc">Return the header information for an NPY file.</div><div class="ttdef"><b>Definition</b> npy.h:331</div></div>
<div class="ttc" id="anamespacenpy_html_a600eb6c59cbacf81349556a92deffa11aa60c6c694491d75b439073b8cb05b139"><div class="ttname"><a href="namespacenpy.html#a600eb6c59cbacf81349556a92deffa11aa60c6c694491d75b439073b8cb05b139">npy::endian_t::BIG</a></div><div class="ttdeci">@ BIG</div><div class="ttdoc">Indicates the use of big-endian encoding.</div></div>
<div class="ttc" id="anamespacenpy_html_a89c763e3f4dbd0b67dc58779381a0ca6"><div class="ttname"><a href="namespacenpy.html#a89c763e3f4dbd0b67dc58779381a0ca6">npy::save</a></div><div class="ttdeci">void save(std::basic_ostream&lt; CHAR &gt; &amp;output, const T &amp;tensor, endian_t endianness=npy::endian_t::NATIVE)</div><div class="ttdoc">Saves a tensor to the provided stream.</div><div class="ttdef"><b>Definition</b> npy.h:204</div></div>
<div class="ttc" id="anpy_8h_html"><div class="ttname"><a href="npy_8h.html">npy.h</a></div><div class="ttdoc">Definitions for reading and writing NPY and NPZ files The libnpy library provides a means to read and...</div></div>
<div class="ttc" id="astructnpy_1_1header__info_html"><div class="ttname"><a href="structnpy_1_1header__info.html">npy::header_info</a></div><div class="ttdoc">Class representing the header info for an NPY file.</div><div class="ttdef"><b>Definition</b> npy.h:109</div></div>
</div><!-- fragment --><p>The generated documentation contains more details on all of the functionality. We hope you find that the library fulfills your needs and is easy to use, but if you have any difficulties please create <a href="https://github.com/matajoh/libnpy/issues">issues</a> so the maintainers can make the library even better. Thanks! </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
